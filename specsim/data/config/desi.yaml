name: DESI QuickSim

# The base path is pre-pended to all non-absolute path values below.
# {...} will be expanded using environment variables.
base_path: '{DESIMODEL}/data'

# Be verbose during the simulation?
verbose: yes

# Specify the wavelength grid to use for simulation.
wavelength:
    unit: Angstrom
    min: 3500.3
    max: 9999.7
    step: 0.1

# The atmosphere configuration is interpreted and validated by the
# specsim.atmosphere module.
atmosphere:
    # Sky emission surface brightness.
    sky:
        table:
            # The .dat extension is not automatically recognized as ascii.
            format: ascii
            columns:
                wavelength: { index: 0, unit: Angstrom }
                surface_brightness:
                    index: 1
                    # Note the factor of 1e-17 in the units!
                    unit: 1e-17 erg / (Angstrom arcsec2 cm2 s)
            path:
                # Select one of these based on the observing conditions.
                spectra/spec-sky.dat
                ##spectra/spec-sky-grey.dat
                ##spectra/spec-sky-bright.dat
    # Zenith extinction coefficients.
    extinction:
        table:
            format: ascii
            columns:
                wavelength: { index: 0, unit: Angstrom }
                extinction_coefficient: { index: 1 }
            path: spectra/ZenithExtinction-KPNO.dat
    # Should extinction be applied to the sky emission?
    extinct_emission: no
    # Airmass to use.
    airmass: 1.0

# The instrument configuration is interpreted and validated by the
# specsim.instrument module.
instrument:
    name: DESI
    constants:
        exposure_time: 1000.0 s
        primary_mirror_diameter: 3.797 m
        obscuration_diameter: 1.8 m
        support_width: 0.025 m
        # Averaged over the focal plane for 107.0 um physical diameter.
        fiber_diameter: 1.52 arcsec
    fiberloss:
        table:
            format: ascii
            path:
                # Select one of these based on the source type.
                throughput/fiberloss-qso.dat
                ##throughput/fiberloss-elg.dat
                ##throughput/fiberloss-lrg.dat
                ##throughput/fiberloss-star.dat
                ##throughput/fiberloss-sky.dat
                ##throughput/fiberloss-perfect.dat
            columns:
                wavelength: { index: 0, unit: Angstrom }
                fiber_acceptance: { index: 1 }
    cameras:
        b:
            constants:
                wavelength_min: 3569 Angstrom
                wavelength_max: 5949 Angstrom
                read_noise: 3.0 electron
                # We treat "pixel" as a linear unit, so we need pixel**2 here.
                dark_current: 3.0 electron/(hour pixel**2)
                gain: 1.0 electron/adu
            psf:
                table:
                    path: specpsf/psf-quicksim.fits
                    hdu: QUICKSIM-B
                    extrapolated_value: 0.0
                    columns:
                        wavelength: { name: wavelength }
                        angstroms_per_row:
                            name: angstroms_per_row
                            # The file uses Angstrom / row but "row" is not
                            # recognized by astropy.units so we replace it with
                            # the linear "pixel" unit.
                            unit: Angstrom / pixel
                            override_unit: yes
                        fwhm_wave: { name: fwhm_wave }
                        neff_spatial: { name: neff_spatial }
            throughput:
                table:
                    path: throughput/thru-B.fits
                    hdu: THROUGHPUT
                    extrapolated_value: 0.0
                    columns:
                        wavelength: { name: wavelength, unit: Angstrom }
                        throughput: { name: throughput }
        r:
            constants:
                wavelength_min: 5625 Angstrom
                wavelength_max: 7741 Angstrom
                read_noise: 2.9 electron
                # We treat "pixel" as a linear unit, so we need pixel**2 here.
                dark_current: 2.0 electron/(hour pixel**2)
                gain: 1.0 electron/adu
            psf:
                table:
                    path: specpsf/psf-quicksim.fits
                    hdu: QUICKSIM-R
                    extrapolated_value: 0.0
                    columns:
                        wavelength: { name: wavelength }
                        angstroms_per_row:
                            name: angstroms_per_row
                            # The file uses Angstrom / row but "row" is not
                            # recognized by astropy.units so we replace it with
                            # the linear "pixel" unit.
                            unit: Angstrom / pixel
                            override_unit: yes
                        fwhm_wave: { name: fwhm_wave }
                        neff_spatial: { name: neff_spatial }
            throughput:
                table:
                    path: throughput/thru-R.fits
                    hdu: THROUGHPUT
                    extrapolated_value: 0.0
                    columns:
                        wavelength: { name: wavelength, unit: Angstrom }
                        throughput: { name: throughput }
        z:
            constants:
                wavelength_min: 7435 Angstrom
                wavelength_max: 9834 Angstrom
                read_noise: 2.9 electron
                # We treat "pixel" as a linear unit, so we need pixel**2 here.
                dark_current: 2.0 electron/(hour pixel**2)
                gain: 1.0 electron/adu
            psf:
                table:
                    path: specpsf/psf-quicksim.fits
                    hdu: QUICKSIM-Z
                    extrapolated_value: 0.0
                    columns:
                        wavelength: { name: wavelength }
                        angstroms_per_row:
                            name: angstroms_per_row
                            # The file uses Angstrom / row but "row" is not
                            # recognized by astropy.units so we replace it with
                            # the linear "pixel" unit.
                            unit: Angstrom / pixel
                            override_unit: yes
                        fwhm_wave: { name: fwhm_wave }
                        neff_spatial: { name: neff_spatial }
            throughput:
                table:
                    path: throughput/thru-Z.fits
                    hdu: THROUGHPUT
                    extrapolated_value: 0.0
                    columns:
                        wavelength: { name: wavelength, unit: Angstrom }
                        throughput: { name: throughput }

# The source configuration is interpreted and validated by the
# specsim.source module.
source:
    name: 22nd AB magnitude reference
    table:
        format: ascii
        path: spectra/spec-ABmag22.0.dat
        columns:
            wavelength: { index: 0, unit: Angstrom }
            flux:
                index: 1
                # Note the factor of 1e-17 in the units!
                unit: 1e-17 erg / (Angstrom cm2 s)

# The simulator configuration is interpreted and validated by the
# specsim.simulator module.
simulator:
    # Number of simulation wavelength bins to combine into the output bins.
    downsampling: 5
